# ggtraces - A tidyverse and grammar of graphics powered line traces visualizer  

Author: Chenxin Li, postdoctoral associate at Center for Applied Genetic Technologies, University of Georgia. 

  Contact: [Chenxin.Li@uga.edu](Chenxin.Li@uga.edu)

The main goal of this repository is to empower R users such that we can produce publication quality chromatograms with R. 
Examples and explanations are below. 

The `Scripts/` directory contains `.Rmd` files that generate the graphics shown below. 
It requires R, RStudio, and the rmarkdown package. 

* R: [R Download](https://cran.r-project.org/bin/)
* RStudio: [RStudio Download](https://www.rstudio.com/products/rstudio/download/)
* rmarkdown can be installed using the intall packages interface in RStudio

# TOC

1. Dependencies
2. Required input
3. Functions generated by the workflow
4. Example 
5. Real world datasets 

# Dependencies
```{r}
library(tidyverse)
```
This is a tidyverse based workflow.

# Required input
The workflow requires the input data to be in the tidy format (each row is an observation, and each column is a variable).

It requires the following 3 columns: 

1. The column named `x`, which will be the x axis 
2. the column named `y`, which will be the y axis
3. A `sample` column that indicates the sample ID of each of the traces. 

Addition required values:

1. a vector of sample IDs 
2. x_offset, default = 0.2
3. y_offset, default = 0.4
4. number of traces to plot 

# Functions defined by the workflow
This workflow defines a 6 functions in this order:

1. `find_xy_ranges()` takes the tidy input data frame and finds xmin, xmax, ymin, and ymax. 
2. `make_grid_table()` takes the ranges produced by `find_xy_ranges()` and produce a data frame that will be used to make the coordinate system. Additionally, it requires `x_offset` and `y_offset` and `number_of_traces`. 
3. `make_axis_table()` takes the ranges produced by `find_xy_ranges()` and produce a data frame that will be used to make the coordinate system.
4. `make_coord()` takes the output of `find_xy_ranges()`, `make_grid_table()`, `make_axis_table`, to make a ggplot object that is a blank coordinate system. It also requires `x_offset` and `y_offset` and `number_of_traces`.
5. `map_sample_to_trace()` takes a vector of sample IDs and produce a data frame that maps sample IDs to traces (column of 1 to n). 
6. `plot_traces()` takes the output of all the above and produce a ggplot object. 

# Example
As a example, let's visualize two sine waves. 

The workflow first generates a blank coordinate system, which is a ggplot object (a "grob").

* The coordinate system is definbed by x and y value ranges, as well as number of traces to graph. 
* The perspective of the coordinate system is defined by `x_offset` and `y_offset`.  

![Example blank coord](https://github.com/cxli233/ggtraces/blob/main/Results/blank_coord.png) 

Again, the blank coordinate is a "grob" object. 
We can add ggplot layers to, such as geom, scale, theme, and so on. 

The trace plot in its most basic form, is the blank coordinate system + `geom_line()` to plot the line traces. 

![Example trace plot](https://github.com/cxli233/ggtraces/blob/main/Results/example_1.png)

This is showing two sine ways aligned along a parallelogram. 
This is a grob object. 
We can add more ggplot layers to it if needed, such as replacing the default color palette. 
Usually it requires some final touches to make it look nicer. 

![Example trace plot, but nicer](https://github.com/cxli233/ggtraces/blob/main/Results/example_1_nicer.png)
